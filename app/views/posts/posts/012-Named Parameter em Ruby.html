Creation Date: 30/08/2011
Description: Como simular named parameter em ruby através de uma gem criada por mim.
Keywords: named parameter ruby
Tags: ruby named parameter

<h1 class="first">Introdu&ccedil;&atilde;o</h1>
<p>Depois de me cansar daquela gambiarra de usar hash para simular named parameter em ruby, decidi criar uma gem para amenizar a trabalhosa gambiarra.</p>

<h1>Instalando</h1>
<p>Antes de qualquer coisa temos que instalar a gem named_parameter:</p>
<code class="syntax shell">gem install named_parameter</code>

<h1>Como Usar</h1>
<h2 class="first">O Básico</h2>
<p>Após instalar a gem, só o que precisamos fazer é extender o módulo NamedParameter e em troca ganharemos o método <span class="snippet">named</span> que usaremos antes da definição do método para dizer que este terá parâmetros nomeados, dessa maneira:</p>
<code class="syntax ruby">require 'rubygems'
require 'named_parameter'

class Pessoa
  extend NamedParameter

  named def fala(frase)
    puts "Pessoa falou: #{frase}"
  end
end

Pessoa.new.fala frase: "Legal!" # => Pessoa falou: Legal!</code>
<p>Se esse mesmo código fosse implementado da forma tradicional seria assim:</p>
<code class="syntax ruby">class Pessoa

  def fala(args={})
    frase = args[:frase]
    puts "Pessoa falou: #{frase}"
  end
end

Pessoa.new.fala frase: "Nem tao legal :(" # => Pessoa falou: Nem tao legal :(</code>

<h2>Parâmetros Opcionais</h2>
<p>Caso queiramos utilizar parâmetros opcionais, não teremos problema:</p>
<code class="syntax ruby">require 'rubygems'
require 'named_parameter'

class Pessoa
  extend NamedParameter

  named def fala(frase="Estou Mudo")
    puts "Pessoa falou: #{frase}"
  end
end

Pessoa.new.fala # => Pessoa falou: Estou Mudo
Pessoa.new.fala frase: "Muito Legal!" # => Pessoa falou: Muito Legal!</code>

<h2>Múltiplos Parâmetros</h2>
<p>Também podemos definir múltiplos parâmetros:</p>
<code class="syntax ruby">require 'rubygems'
require 'named_parameter'

class Ponto
  extend NamedParameter

  named def mover_para(x,y,z=0)
    puts "Movido para: [#{x},#{y},#{z}]"
  end
end

Ponto.new.mover_para(y: 30,x: 50) # => Movido para: [50,30,0]
Ponto.new.mover_para(z: 10, y: 30,x: 50) # => Movido para: [50,30,10]</code>

<h1>Cuidado!</h1>
<p>Antes de usar esta gem, lembre-se que ao extender o módulo NamedParameter, o callback <a href="http://ruby-doc.org/core/classes/Module.html#M000460">method_added</a> é sobreescrito. Caso seja necessário sobreescrever esse callback e usar o NamedParameter na mesma classe é necessário utilizar <a href="https://gist.github.com/534772#file_around_alias.rb">around alias</a>!</p>

<h1>Conclusão</h1>
<p>O código fonte da gem está no github: <a href="https://github.com/HugoLnx/named_parameter">https://github.com/HugoLnx/named_parameter</a>. Os testes foram escritos utilizando RSpec. Quem quiser contribuir pode mandar um pull request (com testes por favor).</p>

<h1>Refer&ecirc;ncias</h1>
<ul>
  <li><a href="http://ruby-doc.org/core/classes/Module.html#M000460">Documentação do callback method_added</a></li>
  <li><a href="https://gist.github.com/534772#file_around_alias.rb">Exemplo de uso do around_alias</a></li>
</ul>
